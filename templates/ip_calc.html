{% extends "base.html" %}

{% block conteudo %}
<div class="row mb-4">
    <div class="col-12">
        <h2 class="section-title text-dark" style="border-color: #212529 !important;">
            <i class="bi bi-calculator"></i> Calculadora de Sub-rede IPv4 (Python Server-Side)
        </h2>
        <p class="text-muted">Ferramenta essencial para planejamento de endereçamento, agora processada pelo Back-end em Python.</p>
    </div>
</div>

<div class="row">
    <div class="col-lg-6 mb-4">
        <div class="card shadow-sm h-100">
            <div class="card-header bg-dark text-white fw-bold">
                <i class="bi bi-input-cursor-text"></i> Entrada de Dados
            </div>
            <div class="card-body bg-light">
                <form method="POST" action="{{ url_for('ip_calc') }}">
                    <div class="mb-3">
                        <label class="form-label fw-bold">Endereço IP:</label>
                        <input type="text" name="ip_address" class="form-control font-monospace" placeholder="Ex: 192.168.0.1" value="{{ ip_entrada or '192.168.88.1' }}" required>
                    </div>
                    
                    <div class="mb-4">
                        <label class="form-label fw-bold">Máscara (CIDR):</label>
                        <select name="cidr_mask" class="form-select font-monospace" required>
                            {% set current_cidr = cidr_entrada or 24 %}
                            {% for i in range(32, 7, -1) %}
                                <option value="{{ i }}" {% if i == current_cidr|int %}selected{% endif %}>/{{ i }} ({{ 2**(32-i) }} IPs)</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    {% if erro %}
                    <div class="alert alert-danger" role="alert">
                        {{ erro }}
                    </div>
                    {% endif %}

                    <button type="submit" class="btn btn-dark w-100 fw-bold py-3">
                        CALCULAR REDE EM PYTHON <i class="bi bi-arrow-right-circle ms-2"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <div class="col-lg-6 mb-4">
        {% if resultado %}
        <div id="resultCard" class="card shadow border-dark h-100">
            <div class="card-header bg-success text-white text-center fw-bold fs-5">
                RESULTADO DA ANÁLISE (Back-end)
            </div>
            <div class="card-body p-0">
                <ul class="list-group list-group-flush font-monospace">
                    <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                        <span class="text-muted">Endereço de Rede:</span>
                        <strong id="resNet" class="fs-5 text-primary">{{ net_addr }}/{{ cidr_entrada }}</strong>
                    </li>
                     <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                        <span class="text-muted">Primeiro IP Útil:</span>
                        <strong id="resFirst">{{ first_ip }}</strong>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                        <span class="text-muted">Último IP Útil:</span>
                        <strong id="resLast">{{ last_ip }}</strong>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                        <span class="text-muted">Broadcast:</span>
                        <strong id="resBc" class="text-danger">{{ broadcast }}</strong>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center p-3 bg-light">
                        <span>Máscara Decimal:</span>
                        <span id="resMask">{{ net_mask }}</span>
                    </li>
                     <li class="list-group-item d-flex justify-content-between align-items-center p-3 bg-light">
                        <span>Total de Hosts Úteis:</span>
                        <strong id="resHosts" class="text-success fs-4">{{ hosts|string }}</strong>
                    </li>
                </ul>
            </div>
        </div>
        {% else %}
         <div class="alert alert-info h-100 d-flex align-items-center justify-content-center">
             <h4 class="text-center">Aguardando dados... Preencha o IP e clique em calcular para ver a análise do servidor!</h4>
         </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block scripts %}
{% endblock %}
